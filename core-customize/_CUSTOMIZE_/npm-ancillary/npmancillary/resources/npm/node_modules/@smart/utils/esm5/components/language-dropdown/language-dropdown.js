/**
 * Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved.
 * @module smartutils
 */
/**
 * Copyright (c) 2019 SAP SE or an SAP affiliate company. All rights reserved.
 * @module smartutils
 */
import * as tslib_1 from "tslib";
import { Input } from '@angular/core';
import { DEFAULT_LANGUAGE_ISO, SWITCH_LANGUAGE_EVENT } from '../../constants';
import { LanguageDropdownHelper, LanguageSortStrategy } from './language-dropdown-helper';
import { LanguageDropdownAdapter } from './language-dropdown-adapter';
var LanguageDropdown = /** @class */ (function () {
    function LanguageDropdown(languageService, eventService) {
        this.languageService = languageService;
        this.eventService = eventService;
        this.languageSortStrategy = LanguageSortStrategy.Default;
        this.selectedLanguage = null;
        this.items = [];
        this.initialLanguage = null;
        this.languages = [];
        this.unRegisterEventService = null;
    }
    LanguageDropdown.prototype.ngOnInit = function () {
        var _this = this;
        Promise.all([
            this.languageService.getResolveLocale(),
            this.languageService.getToolingLanguages()
        ]).then(function (_a) {
            var _b = tslib_1.__read(_a, 2), isoCode = _b[0], languages = _b[1];
            _this.items = languages.map(LanguageDropdownAdapter.transform);
            _this.languages = languages;
            _this.setSelectedLanguage(isoCode);
            _this.setInitialLanguage(isoCode);
        });
        this.unRegisterEventService = this.eventService.subscribe(SWITCH_LANGUAGE_EVENT, function () {
            return _this.handleLanguageChange();
        });
    };
    LanguageDropdown.prototype.ngOnDestroy = function () {
        this.unRegisterEventService();
    };
    /**
     * Triggered when an user selects a language.
     * @param {IToolingLanguage} language
     */
    LanguageDropdown.prototype.onSelectedLanguage = function (item) {
        this.languageService.setSelectedToolingLanguage(item.value);
    };
    /**
     * Set initial language to be displayed in dropdown
     *
     * @param {string} isoCode
     */
    LanguageDropdown.prototype.setInitialLanguage = function (isoCode) {
        this.initialLanguage =
            this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(isoCode)) ||
                this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(DEFAULT_LANGUAGE_ISO));
    };
    /**
     * Triggered onInit and when language service sets a new language.
     *
     * @param {IToolingLanguage[]} languages
     * @param {string} isoCode
     */
    LanguageDropdown.prototype.setSelectedLanguage = function (isoCode) {
        var _this = this;
        this.selectedLanguage = LanguageDropdownHelper.findLanguageWithIsoCode(isoCode, this.languages);
        if (this.selectedLanguage) {
            var sortedLanguages = LanguageDropdownHelper.order(this.selectedLanguage, this.languages, { strategy: this.languageSortStrategy });
            this.items = sortedLanguages.map(LanguageDropdownAdapter.transform);
            return;
        }
        // In case the iso code is too specific, it will use the more generic iso code to set the language.
        this.languageService.getResolveLocaleIsoCode().then(function (code) {
            _this.selectedLanguage = LanguageDropdownHelper.findLanguageWithIsoCode(code, _this.languages);
            var sortedLanguages = LanguageDropdownHelper.order(_this.selectedLanguage, _this.languages, { strategy: _this.languageSortStrategy });
            _this.items = sortedLanguages.map(LanguageDropdownAdapter.transform);
        });
    };
    /**
     * Callback for setting the selected language.
     */
    LanguageDropdown.prototype.handleLanguageChange = function () {
        var _this = this;
        this.languageService.getResolveLocale().then(function (isoCode) {
            _this.setSelectedLanguage(isoCode);
        });
    };
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", String)
    ], LanguageDropdown.prototype, "languageSortStrategy", void 0);
    return LanguageDropdown;
}());
export { LanguageDropdown };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFuZ3VhZ2UtZHJvcGRvd24uanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac21hcnQvdXRpbHMvIiwic291cmNlcyI6WyJjb21wb25lbnRzL2xhbmd1YWdlLWRyb3Bkb3duL2xhbmd1YWdlLWRyb3Bkb3duLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7R0FHRzs7QUFFSCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSXRDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzlFLE9BQU8sRUFBRSxzQkFBc0IsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQzFGLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBRXRFO0lBWUksMEJBQW1CLGVBQWdDLEVBQVMsWUFBMkI7UUFBcEUsb0JBQWUsR0FBZixlQUFlLENBQWlCO1FBQVMsaUJBQVksR0FBWixZQUFZLENBQWU7UUFYOUUseUJBQW9CLEdBQXlCLG9CQUFvQixDQUFDLE9BQU8sQ0FBQztRQUU1RSxxQkFBZ0IsR0FBc0IsSUFBb0MsQ0FBQztRQUMzRSxVQUFLLEdBQW9DLEVBQUUsQ0FBQztRQUM1QyxvQkFBZSxHQUFtQyxJQUV4RCxDQUFDO1FBRU0sY0FBUyxHQUF1QixFQUFFLENBQUM7UUFDbkMsMkJBQXNCLEdBQWdCLElBQThCLENBQUM7SUFFYSxDQUFDO0lBRTNGLG1DQUFRLEdBQVI7UUFBQSxpQkFlQztRQWRHLE9BQU8sQ0FBQyxHQUFHLENBQUM7WUFDUixJQUFJLENBQUMsZUFBZSxDQUFDLGdCQUFnQixFQUFFO1lBQ3ZDLElBQUksQ0FBQyxlQUFlLENBQUMsbUJBQW1CLEVBQUU7U0FDN0MsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFDLEVBQWtEO2dCQUFsRCwwQkFBa0QsRUFBakQsZUFBTyxFQUFFLGlCQUFTO1lBQ3hCLEtBQUksQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDLEdBQUcs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Z2h0IChjKSAyMDE5IFNBUCBTRSBvciBhbiBTQVAgYWZmaWxpYXRlIGNvbXBhbnkuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBAbW9kdWxlIHNtYXJ0dXRpbHNcbiAqL1xuXG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSVNlbGVjdEl0ZW0gfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzL2ktc2VsZWN0LWl0ZW0nO1xuaW1wb3J0IHsgSUV2ZW50U2VydmljZSB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMvaS1ldmVudC5zZXJ2aWNlJztcbmltcG9ydCB7IElUb29saW5nTGFuZ3VhZ2UsIExhbmd1YWdlU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xhbmd1YWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgREVGQVVMVF9MQU5HVUFHRV9JU08sIFNXSVRDSF9MQU5HVUFHRV9FVkVOVCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBMYW5ndWFnZURyb3Bkb3duSGVscGVyLCBMYW5ndWFnZVNvcnRTdHJhdGVneSB9IGZyb20gJy4vbGFuZ3VhZ2UtZHJvcGRvd24taGVscGVyJztcbmltcG9ydCB7IExhbmd1YWdlRHJvcGRvd25BZGFwdGVyIH0gZnJvbSAnLi9sYW5ndWFnZS1kcm9wZG93bi1hZGFwdGVyJztcblxuZXhwb3J0IGNsYXNzIExhbmd1YWdlRHJvcGRvd24ge1xuICAgIEBJbnB1dCgpIGxhbmd1YWdlU29ydFN0cmF0ZWd5OiBMYW5ndWFnZVNvcnRTdHJhdGVneSA9IExhbmd1YWdlU29ydFN0cmF0ZWd5LkRlZmF1bHQ7XG5cbiAgICBwdWJsaWMgc2VsZWN0ZWRMYW5ndWFnZTogSVRvb2xpbmdMYW5ndWFnZSA9IChudWxsIGFzIHVua25vd24pIGFzIElUb29saW5nTGFuZ3VhZ2U7XG4gICAgcHVibGljIGl0ZW1zOiBJU2VsZWN0SXRlbTxJVG9vbGluZ0xhbmd1YWdlPltdID0gW107XG4gICAgcHVibGljIGluaXRpYWxMYW5ndWFnZTogSVNlbGVjdEl0ZW08SVRvb2xpbmdMYW5ndWFnZT4gPSAobnVsbCBhcyB1bmtub3duKSBhcyBJU2VsZWN0SXRlbTxcbiAgICAgICAgSVRvb2xpbmdMYW5ndWFnZVxuICAgID47XG5cbiAgICBwcml2YXRlIGxhbmd1YWdlczogSVRvb2xpbmdMYW5ndWFnZVtdID0gW107XG4gICAgcHJpdmF0ZSB1blJlZ2lzdGVyRXZlbnRTZXJ2aWNlOiAoKSA9PiB2b2lkID0gKG51bGwgYXMgdW5rbm93bikgYXMgKCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBsYW5ndWFnZVNlcnZpY2U6IExhbmd1YWdlU2VydmljZSwgcHVibGljIGV2ZW50U2VydmljZTogSUV2ZW50U2VydmljZSkge31cblxuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICBQcm9taXNlLmFsbChbXG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlU2VydmljZS5nZXRSZXNvbHZlTG9jYWxlKCksXG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlU2VydmljZS5nZXRUb29saW5nTGFuZ3VhZ2VzKClcbiAgICAgICAgXSkudGhlbigoW2lzb0NvZGUsIGxhbmd1YWdlc106IFtzdHJpbmcsIElUb29saW5nTGFuZ3VhZ2VbXV0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXRlbXMgPSBsYW5ndWFnZXMubWFwKExhbmd1YWdlRHJvcGRvd25BZGFwdGVyLnRyYW5zZm9ybSk7XG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlcyA9IGxhbmd1YWdlcztcblxuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZExhbmd1YWdlKGlzb0NvZGUpO1xuICAgICAgICAgICAgdGhpcy5zZXRJbml0aWFsTGFuZ3VhZ2UoaXNvQ29kZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudW5SZWdpc3RlckV2ZW50U2VydmljZSA9IHRoaXMuZXZlbnRTZXJ2aWNlLnN1YnNjcmliZShTV0lUQ0hfTEFOR1VBR0VfRVZFTlQsICgpID0+XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUxhbmd1YWdlQ2hhbmdlKClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy51blJlZ2lzdGVyRXZlbnRTZXJ2aWNlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIHdoZW4gYW4gdXNlciBzZWxlY3RzIGEgbGFuZ3VhZ2UuXG4gICAgICogQHBhcmFtIHtJVG9vbGluZ0xhbmd1YWdlfSBsYW5ndWFnZVxuICAgICAqL1xuICAgIG9uU2VsZWN0ZWRMYW5ndWFnZShpdGVtOiBJU2VsZWN0SXRlbTxJVG9vbGluZ0xhbmd1YWdlPikge1xuICAgICAgICB0aGlzLmxhbmd1YWdlU2VydmljZS5zZXRTZWxlY3RlZFRvb2xpbmdMYW5ndWFnZShpdGVtLnZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgaW5pdGlhbCBsYW5ndWFnZSB0byBiZSBkaXNwbGF5ZWQgaW4gZHJvcGRvd25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpc29Db2RlXG4gICAgICovXG5cbiAgICBwcml2YXRlIHNldEluaXRpYWxMYW5ndWFnZShpc29Db2RlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbml0aWFsTGFuZ3VhZ2UgPVxuICAgICAgICAgICAgKHRoaXMuaXRlbXMuZmluZChcbiAgICAgICAgICAgICAgICBMYW5ndWFnZURyb3Bkb3duSGVscGVyLmZpbmRTZWxlY3RMYW5ndWFnZVdpdGhJc29Db2RlUHJlZGljYXRlKGlzb0NvZGUpXG4gICAgICAgICAgICApIGFzIElTZWxlY3RJdGVtPElUb29saW5nTGFuZ3VhZ2U+KSB8fFxuICAgICAgICAgICAgdGhpcy5pdGVtcy5maW5kKFxuICAgICAgICAgICAgICAgIExhbmd1YWdlRHJvcGRvd25IZWxwZXIuZmluZFNlbGVjdExhbmd1YWdlV2l0aElzb0NvZGVQcmVkaWNhdGUoREVGQVVMVF9MQU5HVUFHRV9JU08pXG4gICAgICAgICAgICApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyZWQgb25Jbml0IGFuZCB3aGVuIGxhbmd1YWdlIHNlcnZpY2Ugc2V0cyBhIG5ldyBsYW5ndWFnZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7SVRvb2xpbmdMYW5ndWFnZVtdfSBsYW5ndWFnZXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaXNvQ29kZVxuICAgICAqL1xuICAgIHByaXZhdGUgc2V0U2VsZWN0ZWRMYW5ndWFnZShpc29Db2RlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZExhbmd1YWdlID0gTGFuZ3VhZ2VEcm9wZG93bkhlbHBlci5maW5kTGFuZ3VhZ2VXaXRoSXNvQ29kZShcbiAgICAgICAgICAgIGlzb0NvZGUsXG4gICAgICAgICAgICB0aGlzLmxhbmd1YWdlc1xuICAgICAgICApO1xuXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZExhbmd1YWdlcyA9IExhbmd1YWdlRHJvcGRvd25IZWxwZXIub3JkZXIoXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExhbmd1YWdlLFxuICAgICAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2VzLFxuICAgICAgICAgICAgICAgIHsgc3RyYXRlZ3k6IHRoaXMubGFuZ3VhZ2VTb3J0U3RyYXRlZ3kgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHNvcnRlZExhbmd1YWdlcy5tYXAoTGFuZ3VhZ2VEcm9wZG93bkFkYXB0ZXIudHJhbnNmb3JtKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluIGNhc2UgdGhlIGlzbyBjb2RlIGlzIHRvbyBzcGVjaWZpYywgaXQgd2lsbCB1c2UgdGhlIG1vcmUgZ2VuZXJpYyBpc28gY29kZSB0byBzZXQgdGhlIGxhbmd1YWdlLlxuICAgICAgICB0aGlzLmxhbmd1YWdlU2VydmljZS5nZXRSZXNvbHZlTG9jYWxlSXNvQ29kZSgpLnRoZW4oKGNvZGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExhbmd1YWdlID0gTGFuZ3VhZ2VEcm9wZG93bkhlbHBlci5maW5kTGFuZ3VhZ2VXaXRoSXNvQ29kZShcbiAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgIHRoaXMubGFuZ3VhZ2VzXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc3Qgc29ydGVkTGFuZ3VhZ2VzID0gTGFuZ3VhZ2VEcm9wZG93bkhlbHBlci5vcmRlcihcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTGFuZ3VhZ2UsXG4gICAgICAgICAgICAgICAgdGhpcy5sYW5ndWFnZXMsXG4gICAgICAgICAgICAgICAgeyBzdHJhdGVneTogdGhpcy5sYW5ndWFnZVNvcnRTdHJhdGVneSB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHNvcnRlZExhbmd1YWdlcy5tYXAoTGFuZ3VhZ2VEcm9wZG93bkFkYXB0ZXIudHJhbnNmb3JtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGJhY2sgZm9yIHNldHRpbmcgdGhlIHNlbGVjdGVkIGxhbmd1YWdlLlxuICAgICAqL1xuICAgIHByaXZhdGUgaGFuZGxlTGFuZ3VhZ2VDaGFuZ2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubGFuZ3VhZ2VTZXJ2aWNlLmdldFJlc29sdmVMb2NhbGUoKS50aGVuKChpc29Db2RlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRMYW5ndWFnZShpc29Db2RlKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl19