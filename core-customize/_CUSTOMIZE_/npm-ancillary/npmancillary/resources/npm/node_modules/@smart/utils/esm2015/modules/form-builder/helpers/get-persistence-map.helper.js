/**
 * Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved.
 * @module smartutils
 */
import { FormField, FormGrouping, FormList } from '../models';
/**
 * Get an address book of persisting fields to the actual form path.
 * Example:
 * {
 *   'property': ['tab', 'property']
 *   ...
 * }
 * Where tab is not a persisting property of the model.
 */
export const getPersistenceMap = (form, map = {}, from = [], to = []) => {
    if (form instanceof FormField) {
        if (form.persist) {
            map[from.join('.')] = to;
        }
        return map;
    }
    if (form instanceof FormList || form instanceof FormGrouping) {
        if (form.persist && from.length) {
            map[from.join('.')] = to;
        }
        Object.keys(form.forms).forEach((current) => {
            const child = form.forms[current];
            const toActual = [...to, current];
            if (child.persist) {
                return getPersistenceMap(child, map, [...from, current], toActual);
            }
            return getPersistenceMap(child, map, from, toActual);
        });
    }
    return map;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LXBlcnNpc3RlbmNlLW1hcC5oZWxwZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac21hcnQvdXRpbHMvIiwic291cmNlcyI6WyJtb2R1bGVzL2Zvcm0tYnVpbGRlci9oZWxwZXJzL2dldC1wZXJzaXN0ZW5jZS1tYXAuaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBZ0IsU0FBUyxFQUFFLFlBQVksRUFBRSxRQUFRLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFNUU7Ozs7Ozs7O0dBUUc7QUFDSCxNQUFNLENBQUMsTUFBTSxpQkFBaUIsR0FBRyxDQUM3QixJQUFrQixFQUNsQixNQUFpQyxFQUFFLEVBQ25DLE9BQWlCLEVBQUUsRUFDbkIsS0FBZSxFQUFFLEVBQ1csRUFBRTtJQUM5QixJQUFJLElBQUksWUFBWSxTQUFTLEVBQUU7UUFDM0IsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2QsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7U0FDNUI7UUFFRCxPQUFPLEdBQUcsQ0FBQztLQUNkO0lBRUQsSUFBSSxJQUFJLFlBQVksUUFBUSxJQUFJLElBQUksWUFBWSxZQUFZLEVBQUU7UUFDMUQsSUFBSSxJQUFJLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDN0IsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7U0FDNUI7UUFFRCxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFlLEVBQUUsRUFBRTtZQUNoRCxNQUFNLEtBQUssR0FBSSxJQUFJLENBQUMsS0FBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzNDLE1BQU0sUUFBUSxHQUFHLENBQUMsR0FBRyxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFbEMsSUFBSSxLQUFLLENBQUMsT0FBTyxFQUFFO2dCQUNmLE9BQU8saUJBQWlCLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLE9BQU8sQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO2FBQ3RFO1lBRUQsT0FBTyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUN6RCxDQUFDLENBQUMsQ0FBQztLQUNOO0lBRUQsT0FBTyxHQUFHLENBQUM7QUFDZixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBYnN0cmFjdEZvcm0sIEZvcm1GaWVsZCwgRm9ybUdyb3VwaW5nLCBGb3JtTGlzdCB9IGZyb20gJy4uL21vZGVscyc7XG5cbi8qKlxuICogR2V0IGFuIGFkZHJlc3MgYm9vayBvZiBwZXJzaXN0aW5nIGZpZWxkcyB0byB0aGUgYWN0dWFsIGZvcm0gcGF0aC5cbiAqIEV4YW1wbGU6XG4gKiB7XG4gKiAgICdwcm9wZXJ0eSc6IFsndGFiJywgJ3Byb3BlcnR5J11cbiAqICAgLi4uXG4gKiB9XG4gKiBXaGVyZSB0YWIgaXMgbm90IGEgcGVyc2lzdGluZyBwcm9wZXJ0eSBvZiB0aGUgbW9kZWwuXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRQZXJzaXN0ZW5jZU1hcCA9IChcbiAgICBmb3JtOiBBYnN0cmFjdEZvcm0sXG4gICAgbWFwOiB7IFtzOiBzdHJpbmddOiBzdHJpbmdbXSB9ID0ge30sXG4gICAgZnJvbTogc3RyaW5nW10gPSBbXSxcbiAgICB0bzogc3RyaW5nW10gPSBbXVxuKTogeyBbcGF0aDogc3RyaW5nXTogc3RyaW5nW10gfSA9PiB7XG4gICAgaWYgKGZvcm0gaW5zdGFuY2VvZiBGb3JtRmllbGQpIHtcbiAgICAgICAgaWYgKGZvcm0ucGVyc2lzdCkge1xuICAgICAgICAgICAgbWFwW2Zyb20uam9pbignLicpXSA9IHRvO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1hcDtcbiAgICB9XG5cbiAgICBpZiAoZm9ybSBpbnN0YW5jZW9mIEZvcm1MaXN0IHx8IGZvcm0gaW5zdGFuY2VvZiBGb3JtR3JvdXBpbmcpIHtcbiAgICAgICAgaWYgKGZvcm0ucGVyc2lzdCAmJiBmcm9tLmxlbmd0aCkge1xuICAgICAgICAgICAgbWFwW2Zyb20uam9pbignLicpXSA9IHRvO1xuICAgICAgICB9XG5cbiAgICAgICAgT2JqZWN0LmtleXMoZm9ybS5mb3JtcykuZm9yRWFjaCgoY3VycmVudDogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IChmb3JtLmZvcm1zIGFzIGFueSlbY3VycmVudF07XG4gICAgICAgICAgICBjb25zdCB0b0FjdHVhbCA9IFsuLi50bywgY3VycmVudF07XG5cbiAgICAgICAgICAgIGlmIChjaGlsZC5wZXJzaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFBlcnNpc3RlbmNlTWFwKGNoaWxkLCBtYXAsIFsuLi5mcm9tLCBjdXJyZW50XSwgdG9BY3R1YWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZ2V0UGVyc2lzdGVuY2VNYXAoY2hpbGQsIG1hcCwgZnJvbSwgdG9BY3R1YWwpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWFwO1xufTtcbiJdfQ==