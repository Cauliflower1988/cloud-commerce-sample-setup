/**
 * Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved.
 * @module smartutils
 */
import * as tslib_1 from "tslib";
import { FormField, FormGrouping, FormList } from '../models';
/**
 * Get an address book of persisting fields to the actual form path.
 * Example:
 * {
 *   'property': ['tab', 'property']
 *   ...
 * }
 * Where tab is not a persisting property of the model.
 */
export var getPersistenceMap = function (form, map, from, to) {
    if (map === void 0) { map = {}; }
    if (from === void 0) { from = []; }
    if (to === void 0) { to = []; }
    if (form instanceof FormField) {
        if (form.persist) {
            map[from.join('.')] = to;
        }
        return map;
    }
    if (form instanceof FormList || form instanceof FormGrouping) {
        if (form.persist && from.length) {
            map[from.join('.')] = to;
        }
        Object.keys(form.forms).forEach(function (current) {
            var child = form.forms[current];
            var toActual = tslib_1.__spread(to, [current]);
            if (child.persist) {
                return getPersistenceMap(child, map, tslib_1.__spread(from, [current]), toActual);
            }
            return getPersistenceMap(child, map, from, toActual);
        });
    }
    return map;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LXBlcnNpc3RlbmNlLW1hcC5oZWxwZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac21hcnQvdXRpbHMvIiwic291cmNlcyI6WyJtb2R1bGVzL2Zvcm0tYnVpbGRlci9oZWxwZXJzL2dldC1wZXJzaXN0ZW5jZS1tYXAuaGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQWdCLFNBQVMsRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRTVFOzs7Ozs7OztHQVFHO0FBQ0gsTUFBTSxDQUFDLElBQU0saUJBQWlCLEdBQUcsVUFDN0IsSUFBa0IsRUFDbEIsR0FBbUMsRUFDbkMsSUFBbUIsRUFDbkIsRUFBaUI7SUFGakIsb0JBQUEsRUFBQSxRQUFtQztJQUNuQyxxQkFBQSxFQUFBLFNBQW1CO0lBQ25CLG1CQUFBLEVBQUEsT0FBaUI7SUFFakIsSUFBSSxJQUFJLFlBQVksU0FBUyxFQUFFO1FBQzNCLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNkLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1NBQzVCO1FBRUQsT0FBTyxHQUFHLENBQUM7S0FDZDtJQUVELElBQUksSUFBSSxZQUFZLFFBQVEsSUFBSSxJQUFJLFlBQVksWUFBWSxFQUFFO1FBQzFELElBQUksSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQzdCLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1NBQzVCO1FBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsT0FBZTtZQUM1QyxJQUFNLEtBQUssR0FBSSxJQUFJLENBQUMsS0FBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQzNDLElBQU0sUUFBUSxvQkFBTyxFQUFFLEdBQUUsT0FBTyxFQUFDLENBQUM7WUFFbEMsSUFBSSxLQUFLLENBQUMsT0FBTyxFQUFFO2dCQUNmLE9BQU8saUJBQWlCLENBQUMsS0FBSyxFQUFFLEdBQUcsbUJBQU0sSUFBSSxHQUFFLE9BQU8sSUFBRyxRQUFRLENBQUMsQ0FBQzthQUN0RTtZQUVELE9BQU8saUJBQWlCLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDekQsQ0FBQyxDQUFDLENBQUM7S0FDTjtJQUVELE9BQU8sR0FBRyxDQUFDO0FBQ2YsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWJzdHJhY3RGb3JtLCBGb3JtRmllbGQsIEZvcm1Hcm91cGluZywgRm9ybUxpc3QgfSBmcm9tICcuLi9tb2RlbHMnO1xuXG4vKipcbiAqIEdldCBhbiBhZGRyZXNzIGJvb2sgb2YgcGVyc2lzdGluZyBmaWVsZHMgdG8gdGhlIGFjdHVhbCBmb3JtIHBhdGguXG4gKiBFeGFtcGxlOlxuICoge1xuICogICAncHJvcGVydHknOiBbJ3RhYicsICdwcm9wZXJ0eSddXG4gKiAgIC4uLlxuICogfVxuICogV2hlcmUgdGFiIGlzIG5vdCBhIHBlcnNpc3RpbmcgcHJvcGVydHkgb2YgdGhlIG1vZGVsLlxuICovXG5leHBvcnQgY29uc3QgZ2V0UGVyc2lzdGVuY2VNYXAgPSAoXG4gICAgZm9ybTogQWJzdHJhY3RGb3JtLFxuICAgIG1hcDogeyBbczogc3RyaW5nXTogc3RyaW5nW10gfSA9IHt9LFxuICAgIGZyb206IHN0cmluZ1tdID0gW10sXG4gICAgdG86IHN0cmluZ1tdID0gW11cbik6IHsgW3BhdGg6IHN0cmluZ106IHN0cmluZ1tdIH0gPT4ge1xuICAgIGlmIChmb3JtIGluc3RhbmNlb2YgRm9ybUZpZWxkKSB7XG4gICAgICAgIGlmIChmb3JtLnBlcnNpc3QpIHtcbiAgICAgICAgICAgIG1hcFtmcm9tLmpvaW4oJy4nKV0gPSB0bztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtYXA7XG4gICAgfVxuXG4gICAgaWYgKGZvcm0gaW5zdGFuY2VvZiBGb3JtTGlzdCB8fCBmb3JtIGluc3RhbmNlb2YgRm9ybUdyb3VwaW5nKSB7XG4gICAgICAgIGlmIChmb3JtLnBlcnNpc3QgJiYgZnJvbS5sZW5ndGgpIHtcbiAgICAgICAgICAgIG1hcFtmcm9tLmpvaW4oJy4nKV0gPSB0bztcbiAgICAgICAgfVxuXG4gICAgICAgIE9iamVjdC5rZXlzKGZvcm0uZm9ybXMpLmZvckVhY2goKGN1cnJlbnQ6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSAoZm9ybS5mb3JtcyBhcyBhbnkpW2N1cnJlbnRdO1xuICAgICAgICAgICAgY29uc3QgdG9BY3R1YWwgPSBbLi4udG8sIGN1cnJlbnRdO1xuXG4gICAgICAgICAgICBpZiAoY2hpbGQucGVyc2lzdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQZXJzaXN0ZW5jZU1hcChjaGlsZCwgbWFwLCBbLi4uZnJvbSwgY3VycmVudF0sIHRvQWN0dWFsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGdldFBlcnNpc3RlbmNlTWFwKGNoaWxkLCBtYXAsIGZyb20sIHRvQWN0dWFsKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hcDtcbn07XG4iXX0=