/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ContentChild, Directive, ElementRef, EventEmitter, Output } from '@angular/core';
import { CdkDrag } from '@angular/cdk/drag-drop';
export class DndContainerDirective {
    /**
     * @param {?} element
     */
    constructor(element) {
        this.element = element;
        /**
         * Class added to element, when it's dragged.
         */
        this.CLASS_WHEN_ELEMENT_DRAGGED = 'fd-dnd-on-drag';
        /**
         * Event thrown when the element is moved by 1px
         */
        this.moved = new EventEmitter();
        /**
         * Event thrown when the element is released
         */
        this.released = new EventEmitter();
        /**
         * Event thrown when the element is started to be dragged
         */
        this.started = new EventEmitter();
    }
    /**
     * @hidden
     * @param {?} isBefore
     * @param {?} listMode
     * @return {?}
     */
    getElementChord(isBefore, listMode) {
        /**
         * Takes distance from the beginning of window page
         * @type {?}
         */
        const rect = (/** @type {?} */ (this.element.nativeElement.getBoundingClientRect()));
        /** @type {?} */
        const position = isBefore ? 'before' : 'after';
        /**
         * Depending on the position, gets the left or right side of element
         * @type {?}
         */
        const x = rect.x + (isBefore || listMode ? 0 : this.element.nativeElement.offsetWidth);
        /** Vertically distance is counted by distance from top of the side + half of the element height */
        return {
            x: x,
            position: position,
            y: rect.y + (this.element.nativeElement.offsetHeight / 2)
        };
    }
    /**
     * @hidden
     * @return {?}
     */
    ngAfterContentInit() {
        this.cdkDrag.moved.subscribe((/**
         * @param {?} event
         * @return {?}
         */
        (event) => {
            this.onCdkMove(event);
        }));
        this.cdkDrag.released.subscribe((/**
         * @return {?}
         */
        () => {
            this.onCdkDragReleased();
        }));
        this.cdkDrag.started.subscribe((/**
         * @return {?}
         */
        () => {
            this.onCdkDragStart();
        }));
    }
    /**
     * @hidden
     * @param {?} cdkMovedEvent
     * @return {?}
     */
    onCdkMove(cdkMovedEvent) {
        this.moved.emit(cdkMovedEvent);
    }
    /**
     * @hidden
     * @return {?}
     */
    onCdkDragReleased() {
        /** Remove class which is added, when element is dragged */
        this.element.nativeElement.classList.remove(this.CLASS_WHEN_ELEMENT_DRAGGED);
        this.released.emit();
        /** Resets the position of element. */
        this.cdkDrag.reset();
        /** Removes placeholder element */
        this.removePlaceholder();
    }
    /**
     * @hidden
     * @return {?}
     */
    onCdkDragStart() {
        /** Adds class */
        this.element.nativeElement.classList.add(this.CLASS_WHEN_ELEMENT_DRAGGED);
        if (!this.placeholderElement) {
            this.createPlaceHolder();
        }
        this.started.emit();
    }
    /**
     * @hidden
     * @return {?}
     */
    removePlaceholder() {
        if (this.placeholderElement) {
            this.placeholderElement.remove();
            this.placeholderElement = null;
        }
    }
    /**
     * @hidden
     * @return {?}
     */
    removeLine() {
        if (this.lineElement) {
            this.lineElement.remove();
            this.lineElement = null;
        }
    }
    /**
     * @hidden
     * @param {?} position
     * @param {?} listMode
     * @return {?}
     */
    createLine(position, listMode) {
        /** Creating of line element */
        this.lineElement = document.createElement('DIV');
        if (listMode) {
            this.lineElement.classList.add('drop-area__line');
            this.lineElement.classList.add('drop-area__line--horizontal');
        }
        else {
            this.lineElement.classList.add('drop-area__line');
            this.lineElement.classList.add('drop-area__line--vertical');
        }
        if (position === 'after') {
            this.lineElement.classList.add('after');
        }
        if (position === 'before') {
            this.lineElement.classList.add('before');
        }
        /** Putting element to the container */
        this.element.nativeElement.appendChild(this.lineElement);
    }
    /**
     * @hidden
     * @private
     * @return {?}
     */
    createPlaceHolder() {
        /**
         * Cloning container element
         * @type {?}
         */
        const clone = this.cdkDrag.element.nativeElement.cloneNode(true);
        /** Taking cloned element reference */
        this.placeholderElement = clone.firstChild.parentElement;
        this.placeholderElement.classList.add('fd-dnd-placeholder');
        /** Including element to the container */
        this.element.nativeElement.appendChild(clone);
    }
}
DndContainerDirective.decorators = [
    { type: Directive, args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[fd-dnd-container]',
                host: {
                    'class': 'fd-dnd-container'
                }
            },] }
];
/** @nocollapse */
DndContainerDirective.ctorParameters = () => [
    { type: ElementRef }
];
DndContainerDirective.propDecorators = {
    cdkDrag: [{ type: ContentChild, args: [CdkDrag, { static: false },] }],
    moved: [{ type: Output }],
    released: [{ type: Output }],
    started: [{ type: Output }]
};
if (false) {
    /**
     * Class added to element, when it's dragged.
     * @type {?}
     */
    DndContainerDirective.prototype.CLASS_WHEN_ELEMENT_DRAGGED;
    /**
     * @type {?}
     * @private
     */
    DndContainerDirective.prototype.placeholderElement;
    /**
     * @type {?}
     * @private
     */
    DndContainerDirective.prototype.lineElement;
    /**
     * @hidden
     * @type {?}
     */
    DndContainerDirective.prototype.cdkDrag;
    /**
     * Event thrown when the element is moved by 1px
     * @type {?}
     */
    DndContainerDirective.prototype.moved;
    /**
     * Event thrown when the element is released
     * @type {?}
     */
    DndContainerDirective.prototype.released;
    /**
     * Event thrown when the element is started to be dragged
     * @type {?}
     */
    DndContainerDirective.prototype.started;
    /** @type {?} */
    DndContainerDirective.prototype.element;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG5kLWNvbnRhaW5lci5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZnVuZGFtZW50YWwtbmd4L2NvcmUvIiwic291cmNlcyI6WyJsaWIvdXRpbHMvZHJhZy1hbmQtZHJvcC9kbmQtY29udGFpbmVyL2RuZC1jb250YWluZXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBRUgsWUFBWSxFQUFFLFNBQVMsRUFDdkIsVUFBVSxFQUFFLFlBQVksRUFDeEIsTUFBTSxFQUNULE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxPQUFPLEVBQWUsTUFBTSx3QkFBd0IsQ0FBQztBQVU5RCxNQUFNLE9BQU8scUJBQXFCOzs7O0lBYTlCLFlBQ1csT0FBbUI7UUFBbkIsWUFBTyxHQUFQLE9BQU8sQ0FBWTs7OztRQVhyQiwrQkFBMEIsR0FBVyxnQkFBZ0IsQ0FBQzs7OztRQWdCdEQsVUFBSyxHQUE4QixJQUFJLFlBQVksRUFBZSxDQUFDOzs7O1FBSW5FLGFBQVEsR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQzs7OztRQUl4RCxZQUFPLEdBQXVCLElBQUksWUFBWSxFQUFRLENBQUM7SUFaN0QsQ0FBQzs7Ozs7OztJQWVHLGVBQWUsQ0FBQyxRQUFpQixFQUFFLFFBQWlCOzs7OztjQUdqRCxJQUFJLEdBQUcsbUJBQVMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQUUsRUFBQTs7Y0FFbEUsUUFBUSxHQUFpQixRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTzs7Ozs7Y0FHdEQsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQztRQUV0RixtR0FBbUc7UUFDbkcsT0FBTztZQUNILENBQUMs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O0lBR2pFLHdDQUNnRTs7SUFiNUQsd0NBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgICBBZnRlckNvbnRlbnRJbml0LFxuICAgIENvbnRlbnRDaGlsZCwgRGlyZWN0aXZlLFxuICAgIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsXG4gICAgT3V0cHV0XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2RrRHJhZywgQ2RrRHJhZ01vdmUgfSBmcm9tICdAYW5ndWxhci9jZGsvZHJhZy1kcm9wJztcbmltcG9ydCB7IEVsZW1lbnRDaG9yZCwgTGlua1Bvc2l0aW9uIH0gZnJvbSAnLi4vZG5kLWxpc3QvZG5kLWxpc3QuZGlyZWN0aXZlJztcblxuQERpcmVjdGl2ZSh7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRpcmVjdGl2ZS1zZWxlY3RvclxuICAgIHNlbGVjdG9yOiAnW2ZkLWRuZC1jb250YWluZXJdJyxcbiAgICBob3N0OiB7XG4gICAgICAgICdjbGFzcyc6ICdmZC1kbmQtY29udGFpbmVyJ1xuICAgIH1cbn0pXG5leHBvcnQgY2xhc3MgRG5kQ29udGFpbmVyRGlyZWN0aXZlIGltcGxlbWVudHMgQWZ0ZXJDb250ZW50SW5pdCB7XG5cbiAgICAvKiogQ2xhc3MgYWRkZWQgdG8gZWxlbWVudCwgd2hlbiBpdCdzIGRyYWdnZWQuICovXG4gICAgcmVhZG9ubHkgQ0xBU1NfV0hFTl9FTEVNRU5UX0RSQUdHRUQ6IHN0cmluZyA9ICdmZC1kbmQtb24tZHJhZyc7XG5cbiAgICBwcml2YXRlIHBsYWNlaG9sZGVyRWxlbWVudDogSFRNTEVsZW1lbnQ7XG5cbiAgICBwcml2YXRlIGxpbmVFbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgQENvbnRlbnRDaGlsZChDZGtEcmFnLCB7IHN0YXRpYzogZmFsc2UgfSlcbiAgICBjZGtEcmFnOiBDZGtEcmFnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgICkge31cblxuICAgIC8qKiBFdmVudCB0aHJvd24gd2hlbiB0aGUgZWxlbWVudCBpcyBtb3ZlZCBieSAxcHggKi9cbiAgICBAT3V0cHV0KClcbiAgICByZWFkb25seSBtb3ZlZDogRXZlbnRFbWl0dGVyPENka0RyYWdNb3ZlPiA9IG5ldyBFdmVudEVtaXR0ZXI8Q2RrRHJhZ01vdmU+KCk7XG5cbiAgICAvKiogRXZlbnQgdGhyb3duIHdoZW4gdGhlIGVsZW1lbnQgaXMgcmVsZWFzZWQgKi9cbiAgICBAT3V0cHV0KClcbiAgICByZWFkb25seSByZWxlYXNlZDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gICAgLyoqIEV2ZW50IHRocm93biB3aGVuIHRoZSBlbGVtZW50IGlzIHN0YXJ0ZWQgdG8gYmUgZHJhZ2dlZCAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHJlYWRvbmx5IHN0YXJ0ZWQ6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIGdldEVsZW1lbnRDaG9yZChpc0JlZm9yZTogYm9vbGVhbiwgbGlzdE1vZGU6IGJvb2xlYW4pOiBFbGVtZW50Q2hvcmQge1xuXG4gICAgICAgIC8qKiBUYWtlcyBkaXN0YW5jZSBmcm9tIHRoZSBiZWdpbm5pbmcgb2Ygd2luZG93IHBhZ2UgKi9cbiAgICAgICAgY29uc3QgcmVjdCA9IDxET01SZWN0PnRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uOiBMaW5rUG9zaXRpb24gPSBpc0JlZm9yZSA/ICdiZWZvcmUnIDogJ2FmdGVyJztcblxuICAgICAgICAvKiogRGVwZW5kaW5nIG9uIHRoZSBwb3NpdGlvbiwgZ2V0cyB0aGUgbGVmdCBvciByaWdodCBzaWRlIG9mIGVsZW1lbnQgKi9cbiAgICAgICAgY29uc3QgeCA9IHJlY3QueCArIChpc0JlZm9yZSB8fCBsaXN0TW9kZSA/IDAgOiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCk7XG5cbiAgICAgICAgLyoqIFZlcnRpY2FsbHkgZGlzdGFuY2UgaXMgY291bnRlZCBieSBkaXN0YW5jZSBmcm9tIHRvcCBvZiB0aGUgc2lkZSArIGhhbGYgb2YgdGhlIGVsZW1lbnQgaGVpZ2h0ICovXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgcG9zaXRpb246IHBvc2l0aW9uLFxuICAgICAgICAgICAgeTogcmVjdC55ICsgKHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCAvIDIpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwdWJsaWMgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNka0RyYWcubW92ZWQuc3Vic2NyaWJlKChldmVudDogQ2RrRHJhZ01vdmUpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DZGtNb3ZlKGV2ZW50KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY2RrRHJhZy5yZWxlYXNlZC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5vbkNka0RyYWdSZWxlYXNlZCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jZGtEcmFnLnN0YXJ0ZWQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25DZGtEcmFnU3RhcnQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwdWJsaWMgb25DZGtNb3ZlKGNka01vdmVkRXZlbnQ6IENka0RyYWdNb3ZlKTogdm9pZCB7XG4gICAgICAgIHRoaXMubW92ZWQuZW1pdChjZGtNb3ZlZEV2ZW50KTtcbiAgICB9XG5cbiAgICAvKiogQGhpZGRlbiAqL1xuICAgIHB1YmxpYyBvbkNka0RyYWdSZWxlYXNlZCgpOiB2b2lkIHtcbiAgICAgICAgLyoqIFJlbW92ZSBjbGFzcyB3aGljaCBpcyBhZGRlZCwgd2hlbiBlbGVtZW50IGlzIGRyYWdnZWQgKi9cbiAgICAgICAgdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLkNMQVNTX1dIRU5fRUxFTUVOVF9EUkFHR0VEKTtcbiAgICAgICAgdGhpcy5yZWxlYXNlZC5lbWl0KCk7XG5cbiAgICAgICAgLyoqIFJlc2V0cyB0aGUgcG9zaXRpb24gb2YgZWxlbWVudC4gKi9cbiAgICAgICAgdGhpcy5jZGtEcmFnLnJlc2V0KCk7XG5cbiAgICAgICAgLyoqIFJlbW92ZXMgcGxhY2Vob2xkZXIgZWxlbWVudCAqL1xuICAgICAgICB0aGlzLnJlbW92ZVBsYWNlaG9sZGVyKCk7XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwdWJsaWMgb25DZGtEcmFnU3RhcnQoKTogdm9pZCB7XG4gICAgICAgIC8qKiBBZGRzIGNsYXNzICovXG4gICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5DTEFTU19XSEVOX0VMRU1FTlRfRFJBR0dFRCk7XG4gICAgICAgIGlmICghdGhpcy5wbGFjZWhvbGRlckVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUGxhY2VIb2xkZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXJ0ZWQuZW1pdCgpO1xuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIHJlbW92ZVBsYWNlaG9sZGVyKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wbGFjZWhvbGRlckVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgdGhpcy5wbGFjZWhvbGRlckVsZW1lbnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqIEBoaWRkZW4gKi9cbiAgICBwdWJsaWMgcmVtb3ZlTGluZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMubGluZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMubGluZUVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICB0aGlzLmxpbmVFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBAaGlkZGVuICovXG4gICAgcHVibGljIGNyZWF0ZUxpbmUocG9zaXRpb246IExpbmtQb3NpdGlvbiwgbGlzdE1vZGU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgLyoqIENyZWF0aW5nIG9mIGxpbmUgZWxlbWVudCAqL1xuICAgICAgICB0aGlzLmxpbmVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gICAgICAgIGlmIChsaXN0TW9kZSkge1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkcm9wLWFyZWFfX2xpbmUnKTtcbiAgICAgICAgICAgIHRoaXMubGluZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJvcC1hcmVhX19saW5lLS1ob3Jpem9udGFsJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxpbmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3AtYXJlYV9fbGluZScpO1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkcm9wLWFyZWFfX2xpbmUtLXZlcnRpY2FsJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYWZ0ZXInKSB7XG4gICAgICAgICAgICB0aGlzLmxpbmVFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FmdGVyJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYmVmb3JlJykge1xuICAgICAgICAgICAgdGhpcy5saW5lRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdiZWZvcmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKiBQdXR0aW5nIGVsZW1lbnQgdG8gdGhlIGNvbnRhaW5lciAqL1xuICAgICAgICB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmxpbmVFbGVtZW50KTtcbiAgICB9XG5cbiAgICAvKiogQGhpZGRlbiAqL1xuICAgIHByaXZhdGUgY3JlYXRlUGxhY2VIb2xkZXIoKTogdm9pZCB7XG4gICAgICAgIC8qKiBDbG9uaW5nIGNvbnRhaW5lciBlbGVtZW50ICovXG4gICAgICAgIGNvbnN0IGNsb25lID0gdGhpcy5jZGtEcmFnLmVsZW1lbnQubmF0aXZlRWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICAgICAgLyoqIFRha2luZyBjbG9uZWQgZWxlbWVudCByZWZlcmVuY2UgKi9cbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlckVsZW1lbnQgPSBjbG9uZS5maXJzdENoaWxkLnBhcmVudEVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZmQtZG5kLXBsYWNlaG9sZGVyJyk7XG5cbiAgICAgICAgLyoqIEluY2x1ZGluZyBlbGVtZW50IHRvIHRoZSBjb250YWluZXIgKi9cbiAgICAgICAgdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuYXBwZW5kQ2hpbGQoY2xvbmUpO1xuICAgIH1cbn1cbiJdfQ==